<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8"/>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>index</title>
    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<!-- ヘッダー -->
	<div id="header-outer"></div>
<!-- ナビバー -->
	<div id="navbar-outer"></div>
	
	<div class="container">
		<div class="row">
				<h1>トレーニング記録</h1>
				<form th:action="@{/insert}" method="post" class="col-sm-offset-1">
					<span>日時<input type="date" name="date" data-validation-error-msg-container="#date-error-dialog"></span>
					<div id="form">
						<div class="col-sm-12">
							<span class="col-sm-2">
								<select name="trainingId" data-validation-error-msg-container="#trainingId-error-dialog">
									<option th:text="メニュー" value="" selected />
									<option th:each="training : ${trainingList}" th:text="${training.trainingName}" th:value="${training.id}">
								</select>
							</span>
							<span class="col-sm-2">
								<input type="text" name="weight" size="8" maxlength="6">
								&nbsp;kg&nbsp;&nbsp;☓
							</span>
							<span class="col-sm-2">
								<select id="repetition" name="repetition" data-validation-error-msg-container="#repetition-error-dialog">
									<option th:text="--" value="" selected/>
								</select>
								&nbsp;回&nbsp;&nbsp;☓
							</span>
							<span class="col-sm-2" style="padding:0">
								<select id="setCount" name="setCount" data-validation-error-msg-container="#setCount-error-dialog">
									<option th:text="--" value="" selected/>
								</select>
								&nbsp;セット
							</span>
							<span class="col-sm-1">
								<input type="button" class="removeCurrent" value="削除">
							</span>
						</div>
					</div>
					<input type="submit" value="記録する">
					<input type="button" id="appendForm" value="+">
					<input type="button" id="removeForm" value="-">
				</form>
		</div>
	</div>
	
<!-- フッター -->
	<div id="footer-outer"></div>
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-form-validator/2.3.26/jquery.form-validator.min.js"></script>
    
    <script type="text/javascript">
		$(function(){
			$("#header-outer").load("header #header");
			$("#navbar-outer").load("navbar #navbar");
			$("#footer-outer").load("footer #footer");
		});
		$(window).load(function () {
			$("#index").attr("class", "active");
		});
		$(function(){
			for(var i = 1; i <= 50; i++){
				$('#repetition').append('<option value=\"' + i + '\">' + i + '</option>')
			}
			for(var i = 1; i <= 20; i++){
				$('#setCount').append('<option value=\"' + i + '\">' + i + '</option>')
			}
		});
		function formValidation(){
			var msg_required="必須入力です。";
			
			$("[name='date']").attr("data-validation", "required");
			$("[name='date']").attr("data-validation-error-msg", '日時は' + msg_required);
			
			$("[name='trainingId']").attr("data-validation", "required");
			$("[name='trainingId']").attr("data-validation-error-msg", 'メニューは' + msg_required);
			
			$("[name='repetition']").attr("data-validation", "required");
			$("[name='repetition']").attr("data-validation-error-msg", '回数は' + msg_required);
			
			$("[name='setCount']").attr("data-validation", "required");
			$("[name='setCount']").attr("data-validation-error-msg", 'セット数は' + msg_required);

			$.validate({
			    errorMessagePosition : 'top',
			    language : {
			    	errorTitle: 'フォームの送信に失敗しました'
			    }
			});
		};
		formValidation();
		function removeCurrent(){
			$('.removeCurrent').click(function(){
				$(this).parent().parent().remove();
			})
		};
		removeCurrent();
		$(function(){
			var form = $('#form').html();
			$('#appendForm').click(function(){
				$('#form').append(form);
				formValidation();
				removeCurrent();
			});
		});
		$('#removeForm').click(function(){
			$('#form div:last-child').remove();
		});
	</script>
</body>
</html>
